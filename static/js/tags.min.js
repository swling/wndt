function _add_input_tag(t,n){let e=$(t).closest(".tags-input");if("-1"!=_tags_values.indexOf(n))return $(e).find("input[type=text]").val(""),!1;if(_tags_values.length>=_max_tag_num)return console.log("_max_tag_num："+_max_tag_num),!1;let a='<span class="tag is-medium is-danger is-light">'+n+'<span class="delete"></span></span>\n';$(e).find(".data").append(a),$(e).find("input[type=text]").val(""),_synchronize_values(t)}function _synchronize_values(t){let n=$(t).closest(".tags-input");return _tags_values=n.tagsValues(),console.log(_tags_values),$(n).find("input[type=hidden]").val(_tags_values),_tags_values.length>=_max_tag_num?(n.find("input").prop("readonly",!0),n.find(".autocomplete-items").html(""),!1):(n.find("input").prop("readonly",!1),!1)}function _run_suggestions(t,n){let e=$(t).closest(".tags-input").find(".autocomplete-items");if(e.html(""),!n)return[];let a={data:"wnd_term_searcher",param:{search:n,taxonomy:$(t).data("taxonomy")}};$.ajax({type:"GET",url:wnd_jsonget_api,data:a,beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",wnd.rest_nonce)},success:function(t){$.each(t,function(t,a){if("-1"==a.indexOf(n))return!0;let i=$('<li class="suggest-items">'+a+"</li>").hide();e.append(i),i.show()})}})}let _tags_values=null;var _max_tag_num=void 0!==_max_tag_num?_max_tag_num:3;let _current_input_value=null;$.fn.tagsValues=function(t){let n=[];return $(this).find(".data .tag").each(function(t,e){let a=$(e).text();n.push(a)}),n},jQuery(document).ready(function(t){_synchronize_values(".tags-input"),t(document).on("click",".tags-input",function(){t(this).find("input").focus()}),t(document).on("click",".tags-input .data .tag .delete",function(){let n=t(this).closest(".tags-input");t(this).parent().remove(),_synchronize_values(n)}),t(document).on("click",".tags-input .autocomplete-items li",function(){let n=t(this).closest(".tags-input"),e=t(this).text(),a=n.find(".data");_add_input_tag(a,e,e),_synchronize_values(t(this)),n.find(".autocomplete-items").html("")}),t(document).on("keydown",".tags-input input",function(n){if(13==n.which||188==n.which||"-1"!=t(this).val().indexOf("，")){let n=t(this).val();n=t(this).val().replace("，",""),n=n.replace(",",""),t(this).val(n),""!=n&&_add_input_tag(this,n)}}),t(document).on("keyup",".tags-input input",function(n){return!t(this).prop("readonly")&&(_current_input_value!=t(this).val()&&(_current_input_value=t(this).val(),void("function"==typeof _run_suggestions&&_run_suggestions(this,_current_input_value))))})});