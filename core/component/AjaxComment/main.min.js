$(document).ready(function(e){var t=$("#cancel-comment-reply-link"),a=t.text(),o=$("#commentform [type='submit']");$("#commentform").on("submit",function(t){t.preventDefault();var a=new FormData($("#commentform").get(0));return e.ajax({url:ajaxcomment.api_url,data:a,type:$(this).attr("method"),contentType:!1,processData:!1,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ajaxcomment.rest_nonce),addComment.createButterbar("提交中...."),o.prop("disabled",!0)},error:function(e){var t=addComment;t.createButterbar(e.responseText),o.prop("disabled",!1)},success:function(e){if(0!=e.status){$("textarea").each(function(){this.value=""});m=addComment;var t=m.I("cancel-comment-reply-link"),a=m.I("wp-temp-form-div"),n=m.I(m.respondId),r=(m.I("comment_post_ID").value,m.I("comment_parent").value);"0"!=r?$("#respond").before('<ol class="children">'+e.data+"</ol>"):$("."+ajaxcomment.wrapper).length?"asc"==ajaxcomment.order?$("."+ajaxcomment.wrapper).append(e.data):$("."+ajaxcomment.wrapper).prepend(e.data):"bottom"==ajaxcomment.formpostion?$("#respond").before('<ol class="'+ajaxcomment.wrapper+'">'+e.data+"</ol>"):$("#respond").after('<ol class="'+ajaxcomment.wrapper+'">'+e.data+"</ol>"),m.createButterbar("提交成功"),o.prop("disabled",!1),t.style.display="none",t.onclick=null,m.I("comment_parent").value="0",a&&n&&(a.parentNode.insertBefore(n,a),a.parentNode.removeChild(a))}else{var m=addComment;m.createButterbar(e.msg)}}}),!1}),addComment={moveForm:function(e,o,n){var r,m=this,d=m.I(e),c=m.I(n),l=m.I("cancel-comment-reply-link"),p=m.I("comment_parent");m.I("comment_post_ID");t.text(a),m.respondId=n,m.I("wp-temp-form-div")||(r=document.createElement("div"),r.id="wp-temp-form-div",r.style.display="none",c.parentNode.insertBefore(r,c)),d?d.parentNode.insertBefore(c,d.nextSibling):(temp=m.I("wp-temp-form-div"),m.I("comment_parent").value="0",temp.parentNode.insertBefore(c,temp),temp.parentNode.removeChild(temp)),$("body").animate({scrollTop:$("#respond").offset().top-180},400),p.value=o,l.style.display="",l.onclick=function(){var e=addComment,t=e.I("wp-temp-form-div"),a=e.I(e.respondId);return e.I("comment_parent").value="0",t&&a&&(t.parentNode.insertBefore(a,t),t.parentNode.removeChild(t)),this.style.display="none",this.onclick=null,!1};try{m.I("comment").focus()}catch(e){}return!1},I:function(e){return document.getElementById(e)},clearButterbar:function(e){$("#ajax-comment-modal").length>0&&$("#ajax-comment-modal").remove()},createButterbar:function(e){var t=this;t.clearButterbar(),$("body").append('<div id="ajax-comment-modal" class="modal is-active"><div class="modal-background"></div><div class="modal-content"><div class="modal-entry has-text-centered"><p class="ajax-comment-message">'+e+'</p></div></div><button class="modal-close is-large" aria-label="close"></button></div>'),setTimeout('$("#ajax-comment-modal").remove()',2e3)}}});